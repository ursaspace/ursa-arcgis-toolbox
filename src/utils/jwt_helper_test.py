import unittest
from . import jwt_helper


class JwtHelperTestCase(unittest.TestCase):
    MOCK_TOKEN = "eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwbGF0Zm9ybS51cnNhc3BhY2UuY29tIiwiYXVkIjoidXJzYS1tYWpvciIsImp0aSI6IkRRMzdoRFZOZG1wQkY4QnAzekJGOFEiLCJpYXQiOjE2NzM1NDc3NTIsImV4cCI6MTY3MzU3NjU1MiwibmJmIjoxNjczNTQ3NjMyLCJzdWIiOiJicmVuZGFuLmN1bGxlbkB1cnNhc3BhY2UuY29tICIsInByaW5jaXBhbF9pZCI6IjdhNjczMTM1LTljNmEtNDllZC1iYzY1LWMxODQ2M2VmNzcxMyIsInByaW5jaXBhbF9uYW1lIjoiYnJlbmRhbi5jdWxsZW5AdXJzYXNwYWNlLmNvbSIsInNlY3VyaXR5X3JvbGVzIjpbIkFPUy53b3JrZmxvdy5tb25pdG9yIiwiQU9TLndvcmtmbG93LnN1Ym1pdCIsIkNNUy5BY2Nlc3NPcmRlci5QT1NUIiwiQ01TLkNhdGFsb2dPcmRlci5HRVQiLCJDTVMuQ2F0YWxvZ09yZGVyLlBPU1QiLCJDTVMuRGVsaXZlciIsIkNNUy5GZWFzaWJpbGl0eU9yZGVyLkdFVCIsIkNNUy5GZWFzaWJpbGl0eU9yZGVyLlBPU1QiLCJDTVMuVGFza2luZ09yZGVyLkdFVCIsIkNNUy5UcmFja2luZyIsIklNRFMuVXBsb2FkLlNoYXBlZmlsZS5QdWJsaWMuUE9TVCIsIklPUy5Db250cmFjdC5DcmVhdGUiLCJJT1MuQ29udHJhY3QuR2V0IiwiSU9TLkN1c3RvbWVyLkNyZWF0ZSIsIklPUy5DdXN0b21lci5HZXQiLCJJT1MuRmVhc2liaWxpdHkuUmVxdWVzdCIsIklPUy5GZWFzaWJpbGl0eS5TZWFyY2giLCJJT1MuT3JkZXIuQ2FuY2VsIiwiSU9TLk9yZGVyLkNyZWF0ZSIsIklPUy5PcmRlci5EZWxpdmVyIiwiSU9TLk9yZGVyLkRvd25sb2FkIiwiSU9TLk9yZGVyLlBheS5TdHJpcGUiLCJJT1MuT3JkZXIuU3RhdHVzLkdldCIsIklUUy5Jbmdlc3QuQnVsay5HZXQiLCJJVFMuSW5nZXN0LkJ1bGsuUG9zdCIsIklUUy5Jbmdlc3QuUmVjdXJyaW5nLkRlbGV0ZSIsIklUUy5Jbmdlc3QuUmVjdXJyaW5nLkdldCIsIklUUy5Jbmdlc3QuUmVjdXJyaW5nLlBvc3QiLCJJVFMuSW5nZXN0UmVxdWVzdC5HZXQiLCJJVFMuSW5nZXN0UmVxdWVzdC5Qb3N0IiwiT0FJUy5RdWVyeS5Hcm91cEJ5IiwiT0FJUy5RdWVyeS5TZWxlY3QiLCJQQU5UUy5EZWxpdmVyeS5HRVQiLCJQQU5UUy5Ob3RpZmljYXRpb24uR0VUIiwiUEFOVFMuTm90aWZpY2F0aW9uRGVmaW5pdGlvbi5HRVQiLCJQQU5UUy5TdWJzY3JpcHRpb25zLkRFTEVURSIsIlBBTlRTLlN1YnNjcmlwdGlvbnMuR0VUIiwiUEFOVFMuU3Vic2NyaXB0aW9ucy5QT1NUIiwiUEFSLlJlc3VsdHMuRG93bmxvYWQiLCJQQVIuUmVzdWx0cy5HZXQiLCJQRE0uQmxvYnMuR0VUIiwiUFMuUHJpY2UuSW1hZ2UuUmVxdWVzdCIsIlBTRE0uRGVsZXRlLlBPU1QiLCJQU0RNLlF1ZXJ5LkdyYXBoUUwuR0VUIiwiUFNETS5RdWVyeS5HcmFwaFFMLlBPU1QiLCJQU0RNLlJlY29yZHMuR0VUIiwiUFRNLlJlYWQiLCJTUFhZLkxvZy5Qcm9kdWNlciIsIlNSRE0uRGF0YS5SZWFkIiwiU1JETS5EYXRhLlJlYWQuKiIsIlRvb2xib3guTFdNIiwiVkNNYXAuSW50ZXJuYWwiLCJXQU1TLlF1ZXJ5IiwiV0VTLkRlbGV0ZS5Xb3JrZmxvd1RyaWdnZXIiLCJXRVMuR2V0LldvcmtmbG93VHJpZ2dlciIsIldFUy5Qb3N0LldvcmtmbG93VHJpZ2dlciIsIldFUy5RdWVyeSIsIldFUy5TdGF0dXMiLCJXRVMuU3VibWl0Lk9uRGVtYW5kIiwiV0VTLlN1Ym1pdC5TY2hlZHVsZWQiLCJnbXNzIiwicHJlbWl1bVVzZXIiLCJ1c2VyIl0sImdyb3VwcyI6WyJBT1MgUG9saWN5IiwiQ2F0YWxvZyBPcmRlciBQb2xpY3kiLCJGZWFzaWJpbGl0eSBTZWFyY2ggUG9saWN5IiwiSU1EUyBVcGxvYWQgUG9saWN5IiwiSU9TIE9yZGVyaW5nIFBvbGljeSIsIklUUyBQb2xpY3kiLCJPQUlTIEZ1bGwgQWNjZXNzIFBvbGljeSIsIk9wcGF0IFVzZXIiLCJQQU5UUyBTdWJzY3JpYmVycyIsIlBBUyBQYXNzd29yZCBQb2xpY3kiLCJQRE0gRG93bmxvYWQiLCJQU0RNIERlbGV0ZSBQb2xpY3kiLCJQU0RNIFF1ZXJ5IFBvbGljeSIsIlBhclVzZXJzIiwiUHJlbWl1bSBVc2VyIiwiU1BYWSBMb2cgUG9saWN5IiwiU1JETSBSZWFkIiwiVG9vbGJveCBQb2xpY3kiLCJVUFJOIEludGVybmFsIFVzZXIgUG9saWN5Il19.qTVFnicVaQVGwOlEALUEreHs2GtnbyGyOFY0qeRVrx0"

    def test_email_from_cached_jwt(self):
        email = jwt_helper.email_from_jwt(self.MOCK_TOKEN)
        self.assertEqual(email, "brendan.cullen@ursaspace.com")
